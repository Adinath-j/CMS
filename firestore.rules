rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // Users
    match /users/{uid} {
      allow read: if request.auth != null;
      allow write: if request.auth.uid == uid;
    }

    // Attendance records
   match /attendance/{session}/{studentId} {
  allow read: if request.auth != null;

  allow create: if
    request.auth != null &&
    get(/databases/$(database)/documents/users/$(request.auth.uid)).data.role in ["staff","hod"];

  allow update, delete: if false;
}

match /attendance_summary/{studentId} {
  allow read: if request.auth.uid == studentId;
  allow write: if false;
}

  }
}
